let express,json,cors,puppeteer;_713‍.w("express",[["default",["express"],function(v){express=v}],["json",["json"],function(v){json=v}]]);_713‍.w("cors",[["default",["cors"],function(v){cors=v}]]);_713‍.w("puppeteer",[["default",["puppeteer"],function(v){puppeteer=v}]]);// const puppeteer = require("puppeteer");




const app = express()

app.use(cors());
app.use(express.json());



app.post("/download", async (req, res)=> {

    _713‍.g.console.log(req.body.url)
    return res.send("hello")

    // const lal = await scrap(req)
    // return res.send(lal)
})


const scrap = async (url) => {
  const browser = await puppeteer.launch({
    defaultViewport: false,
  });
  const page = await browser.newPage();
  await page.goto("https://www.y2mate.com/");
  await page.click("#txt-url", { clickCount: 1 });
  await page.type("#txt-url", url);
  await page.click("#btn-submit");
  await page.waitForTimeout(4000);
  const downloadBtn = await page.waitForXPath(
    "/html/body/div[1]/div/div/div/div[1]/div/div/div/div[4]/div[1]/div[2]/div/div[1]/table/tbody/tr[1]/td[3]/button"
  );
  await downloadBtn.click();
  await page.waitForTimeout(3000)
  const downloadLink = await page.$eval('html body#bootstrap-themes.swag-line.modal-open div.container-overflow-wrap div div div.container div.panel.panel-default.m-b-0 div.panel-body div.div-form div.hero.hero-homepage div#progressModal.modal.fade.in div.modal-dialog div.modal-content div.modal-body.text-center div#process-result div.form-group.has-success.has-feedback a.btn.btn-success.btn-file', ele => ele.getAttribute('href'))
  _713‍.g.console.log(downloadLink)
  await browser.close();
  return downloadLink
};

app.listen(5000);


